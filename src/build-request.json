{
  "kind": "build_request",
  "title": "Fix admin panel authorization and user data display for whitelisted admins",
  "projectName": "Game Vault",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-67",
      "text": "Fix the admin authorization logic in the Storefront component so that when a user logged in as 'venomgladiator25' or 'turbohunter64' clicks the Admin button, they are immediately navigated to the admin panel without encountering an 'access denied' error or black screen",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-final"
        ],
        "quotes": [
          "logged in as 'venomgladiator25' or 'turbohunter64' (whitelisted admins), but when you click the Admin button on the storefront, you're seeing an 'access denied' error message instead of entering the admin panel"
        ]
      },
      "acceptanceCriteria": [
        "When logged in as 'venomgladiator25', clicking the Admin button successfully navigates to the admin panel",
        "When logged in as 'turbohunter64', clicking the Admin button successfully navigates to the admin panel",
        "No 'access denied' error or black screen appears for whitelisted admin usernames",
        "The authorization check properly compares the authenticated user's stored username (custom username if available, otherwise AI-generated username) against the whitelist"
      ]
    },
    {
      "id": "REQ-68",
      "text": "Update the QueueSkipSubmissionsList component to fetch and display the username (custom username if available, otherwise AI-generated username) for each queue skip payment submission instead of only showing the principal ID",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-final"
        ],
        "quotes": [
          "all three admin sections (Queue Skip, Username Change/Regeneration, and Custom Username submissions) should display: User's username (their AI-generated or custom username)"
        ]
      },
      "acceptanceCriteria": [
        "Each queue skip submission row displays the submitting user's username",
        "Custom usernames are displayed when the user has one, otherwise AI-generated username is shown",
        "Username column is clearly labeled in the submissions table",
        "Backend endpoint returns username data for each submission"
      ]
    },
    {
      "id": "REQ-69",
      "text": "Update the UsernameChangeSubmissionsList component to fetch and display the username (custom username if available, otherwise AI-generated username) for each username change payment submission instead of only showing the principal ID",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-final"
        ],
        "quotes": [
          "all three admin sections (Queue Skip, Username Change/Regeneration, and Custom Username submissions) should display: User's username (their AI-generated or custom username)"
        ]
      },
      "acceptanceCriteria": [
        "Each username change submission row displays the submitting user's username",
        "Custom usernames are displayed when the user has one, otherwise AI-generated username is shown",
        "Username column is clearly labeled in the submissions table",
        "Backend endpoint returns username data for each submission"
      ]
    },
    {
      "id": "REQ-70",
      "text": "Update the CustomUsernameSubmissionsList component to fetch and display the username (custom username if available, otherwise AI-generated username) for each custom username payment submission instead of only showing the principal ID",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-final"
        ],
        "quotes": [
          "all three admin sections (Queue Skip, Username Change/Regeneration, and Custom Username submissions) should display: User's username (their AI-generated or custom username)"
        ]
      },
      "acceptanceCriteria": [
        "Each custom username submission row displays the submitting user's current username",
        "Custom usernames are displayed when the user has one, otherwise AI-generated username is shown",
        "Username column is clearly labeled in the submissions table",
        "Backend endpoint returns username data for each submission"
      ]
    },
    {
      "id": "REQ-71",
      "text": "Create or update backend endpoints for queue skip, username change, and custom username submissions to include the submitting user's username (prioritizing custom username over AI-generated username) in the response data for each submission record",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-final"
        ],
        "quotes": [
          "ensure all three submission sections can load and display the username for each submission"
        ]
      },
      "acceptanceCriteria": [
        "Queue skip submissions endpoint returns username field for each submission",
        "Username change submissions endpoint returns username field for each submission",
        "Custom username submissions endpoint returns username field for each submission",
        "Backend properly resolves custom username when available, falls back to AI-generated username",
        "All three endpoints return empty arrays when no submissions exist (not errors)"
      ]
    },
    {
      "id": "REQ-72",
      "text": "Verify that the useProfile query hook correctly fetches and caches both the AI-generated username and custom username fields, ensuring the custom username takes precedence when displaying user identity throughout the application",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-final"
        ],
        "quotes": [
          "Custom usernames are displayed when the user has one, otherwise AI-generated username is shown"
        ]
      },
      "acceptanceCriteria": [
        "useProfile hook successfully fetches both username fields from backend",
        "Custom username is prioritized over AI-generated username when both exist",
        "Profile data is properly cached and invalidated on username changes",
        "No null or undefined username values cause authorization failures"
      ]
    }
  ],
  "constraints": [
    "Do not modify the whitelisted admin usernames ('venomgladiator25' and 'turbohunter64')",
    "Maintain existing payment submission data structures and validation",
    "Keep all three payment methods (PayPal, UK gift cards, crypto) functional",
    "Do not change the single-actor backend architecture"
  ],
  "nonGoals": [
    "Adding new admin users or modifying the whitelist mechanism",
    "Changing the payment flow or submission process",
    "Modifying the AI username generation algorithm",
    "Adding new admin panel sections or features",
    "Redesigning the admin panel UI layout"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}